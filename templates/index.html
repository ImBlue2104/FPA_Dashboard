<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>FP&A Dashboard â€” {{ month }}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <h1 class="title">FP&A Dashboard â€” {{ month }}</h1>

    <div class="container">

        <!-- Month Selection -->
        <form method="POST" class="month-form">
            <label for="month">Select Month:</label>
            <select name="month" id="month">
                {% for m in months %}
                    <option value="{{ m }}" {% if month==m %}selected{% endif %}>{{ m }}</option>
                {% endfor %}
            </select>
            <button type="submit" name="set_month">Set Month</button>
        </form>

        <!-- Set Budget -->
        <h2>Set Budget</h2>
        <form method="POST" class="budget-form">
            <input type="number" name="budget" placeholder="Enter monthly budget" step="0.01" required>
            <button type="submit" name="set_budget">Set Budget</button>
            <button type="submit" name="delete_budget">Delete Budget</button>
        </form>

        <!-- Add Expense -->
        <h2>Add Expense</h2>
        <form method="POST" class="expense-form">
            <input type="text" name="expense_name" placeholder="Expense name" required>
            <input type="number" name="expense_amount" placeholder="Amount" step="0.01" required>
            <select name="expense_category" required>
                <option value="" disabled selected>Select category</option>
                <option value="Groceries">Groceries</option>
                <option value="Entertainment">Entertainment</option>
                <option value="Dining">Dining</option>
                <option value="Gas">Gas</option>
                <option value="Other">Other</option>
            </select>
            <button type="submit" name="add_expense">Add Expense</button>
            <button type="submit" name="delete_all_expenses">Delete All Expenses</button>
        </form>

        <!-- Monthly Summary -->
        <h2>Summary</h2>
        <div class="summary">
            <div class="summary-item">Budget: {{ budget }}</div>
            <div class="summary-item">Total Spent: {{ total_spent }}</div>
            <div class="summary-item">Remaining: {{ remaining }}</div>
            {% if growth_rate is not none %}
            <div class="summary-item">Growth Rate vs Previous Month: {{ growth_rate }}%</div>
            {% endif %}
        </div>

        <!-- Expenses List -->
        <h2>Expenses</h2>
        <ul class="expense-list">
            {% for e in expenses %}
            <li class="expense-item">
                <span><strong>Name:</strong> {{ e.name }}</span>
                <span><strong>Amount:</strong> {{ e.amount }}</span>
                <span><strong>Category:</strong> {{ e.category }}</span>
                <form method="POST" style="display:inline;">
                    <input type="hidden" name="delete_expense_name" value="{{ e.name }}">
                    <button type="submit" name="delete_expense" class="delete-expense-btn">âœ–</button>
                </form>
            </li>
            {% endfor %}
        </ul>

        <!-- Charts & Analytics Section -->
        <h2>Expense Analysis</h2>
        <div class="chart-container">
            <canvas id="expenseChart"></canvas>
        </div>

    </div>

    <footer>
        &copy; 2025 FP&A Dashboard
        <p>Created by <em><a href="https://www.linkedin.com/in/neel-patil-a04652354/" target="_blank">Neel Patil</a></em> with ðŸ’–</p>
    </footer>

    <!-- Chart.js library -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Pass category data from Flask to JS -->
    <script id="category-labels" type="application/json">{{ categories | tojson }}</script>
    <script id="category-values" type="application/json">{{ amounts | tojson }}</script>

    <!-- Your script -->
    <script src="{{ url_for('static', filename='script.js') }}"></script>

</body>
</html>
